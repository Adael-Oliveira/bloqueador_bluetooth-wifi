<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <title>Instalador ESP32 - Adael Tech</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script type="module" src="https://unpkg.com/esp-web-tools@10/dist/web/install-button.js?module"></script>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 2rem;
      text-align: center;
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }

    p {
      font-size: 1.2rem;
      margin-bottom: 2rem;
    }

    esp-web-install-button::part(button) {
      background-color: #00d084;
      color: #000;
      padding: 1rem 2rem;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      border: none;
      transition: 0.3s;
    }

    esp-web-install-button::part(button):hover {
      background-color: #00b26e;
    }

    footer {
      margin-top: 3rem;
      font-size: 0.95rem;
      opacity: 0.7;
    }

    a.instagram,
    a.whatsapp {
      color: #fff;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      transition: 0.3s;
      margin-bottom: 0.5rem;
    }

    a.instagram:hover {
      color: #f09433;
    }

    a.whatsapp:hover {
      color: #25d366;
    }

    a.instagram svg,
    a.whatsapp svg {
      width: 20px;
      height: 20px;
      fill: currentColor;
    }
  </style>
</head>

<body>
  <h1>üöÄ Instalador de Firmware ESP32</h1>
  <p>Conecte sua placa ESP32 via USB e clique no bot√£o abaixo:</p>
  <esp-web-install-button manifest="manifest.json"></esp-web-install-button>

  <div style="margin-top: 2rem; background-color: #ffffff10; padding: 1rem; border-radius: 8px;">
    <h3>‚ö†Ô∏è Dispositivo n√£o reconhecido?</h3>
    <p>Se a porta n√£o aparecer, talvez voc√™ precise instalar o driver USB do ESP32.</p>
    <p>
      üëâ Baixe aqui o driver CP210x:
      <a href="https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers" target="_blank" style="color: #00ffff;">
        silabs.com - CP210x USB to UART Bridge
      </a>
    </p>
  </div>

  <footer>
    <a class="instagram" href="https://www.instagram.com/prof_adaeloliveira/" target="_blank" rel="noopener noreferrer">
      <svg viewBox="0 0 448 512" aria-hidden="true" focusable="false"><path d="M224,202.66A53.34,53.34,0,1,0,277.34,256,53.38,53.38,0,0,0,224,202.66Zm124.71-41a54,54,0,0,0-30.71-30.71C296.26,121,224,121,224,121s-72.26,0-93.94,9.94A54,54,0,0,0,99.35,161.65C89.39,183.32,89.39,256,89.39,256s0,72.26,9.94,93.94a54,54,0,0,0,30.71,30.71C151.74,391,224,391,224,391s72.26,0,93.94-9.94a54,54,0,0,0,30.71-30.71C358.61,328.26,358.61,256,358.61,256S358.61,183.32,348.71,161.65ZM224,338a82,82,0,1,1,82-82A82.08,82.08,0,0,1,224,338Zm85.33-148.19a19.2,19.2,0,1,1,19.2-19.2A19.2,19.2,0,0,1,309.33,189.81Z"/></svg>
      prof_adaeloliveira
    </a>
    <br />
    <a class="whatsapp" href="https://wa.me/5518981167681" target="_blank" rel="noopener noreferrer" aria-label="WhatsApp Adael Oliveira">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" aria-hidden="true" focusable="false"><path d="M380.9 97.1C339-6.8 250-29 179.4 22.9 109.4 74.8 81 148.5 95 212c3.1 17.4 11.4 40 24.7 56 5.2 7.1 12.1 15 24.8 20.8 1.3.6 1.5.8 1.5 1.9 0 2-.1 6.9-.1 7.9 0 6 4.7 11 10.6 11.8 63.3 10.4 132.5-37.3 167.2-84.7 34.8-47.4 41-107.4 19.9-140.2zm-64.4 131.4c-13.3 20-35 38.1-56.9 43.3-17 3.9-31.2 2.4-46-5.8-13.3-7.5-22.3-22-26-38.7-1.3-6-1.3-7.1-1.3-17.5 0-10.4 0-11.5 1.4-16 1.4-4.8 10.6-17.6 15-22.1 6.1-7.3 12.4-11 22.5-14 18.5-5.4 36-1.7 50.8 10.4 7.9 6.6 14 15.5 17 26.7 3.5 12 2.3 22.2-1.5 33.7z"/></svg>
      WhatsApp: (18) 98116-7681
    </a>
    <div>Feito com ‚ù§Ô∏è por Adael Oliveira - OficinaMaker</div>
  </footer>

  <script>
    // URL do seu Google Apps Script que valida a senha e registra o uso
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyKRG24a0eIWw41IMzctvhYB9L_7pihGQmyrYOGIgMzLKoY2XXgoFeo08-ecczEJyrVpw/exec";

    async function verificarSenha(senha) {
      try {
        const response = await fetch(`${SCRIPT_URL}?senha=${encodeURIComponent(senha)}`);
        const data = await response.json();
        return data; // espera algo como { valido: true } ou { valido: false, mensagem: "Senha usada" }
      } catch (err) {
        alert("Erro na comunica√ß√£o com o servidor. Tente novamente mais tarde.");
        throw err;
      }
    }

    async function pedirSenha() {
      let senha = prompt("Digite a senha de acesso:");

      if (!senha) {
        alert("Voc√™ precisa digitar a senha para acessar.");
        window.location.href = "https://google.com";
        return;
      }

      const resultado = await verificarSenha(senha);

      if (!resultado.valido) {
        alert(resultado.mensagem || "Senha incorreta ou j√° usada!");
        window.location.href = "https://google.com";
      } else {
        // senha v√°lida, deixa acessar a p√°gina normalmente
      }
    }

    pedirSenha();
  </script>
</body>

</html>
